<header class="topbar" data-topbar>
  <a class="brand-lockup" href="/" aria-label="ColdTreasure Home">
    <div class="brand-text">
      <div class="brand-name">COLD TREASURE</div>
      <div class="brand-slogan">ARCHIVE IS NOT FOR RESALE</div>
    </div>
  </a>

  <nav class="nav" aria-label="Primary">
    <a href="/news/">News</a>
    <a href="/record/">Record</a>
    <a href="/archive/">Archive</a>
  </nav>
</header>

<script>
(function(){
  const path = (location.pathname || "/").toLowerCase();

  // ========== Nav active（你原本的逻辑） ==========
  document.querySelectorAll(".nav a").forEach(a => {
    const href = (a.getAttribute("href") || "").toLowerCase();
    const isNews = (href === "/news/") && (path.startsWith("/news") || path.startsWith("/post"));
    const isSection = (href !== "/news/") && href !== "/" && path.startsWith(href);
    if (isNews || isSection) a.classList.add("is-active");
  });

  // ========== Kith-style Header state ==========
  const topbar = document.querySelector("[data-topbar]");
  if (!topbar) return;

  const isHome = (window.CT_PAGE || "").toLowerCase() === "home" || path === "/" || path === "/index.html";

  // 规则：
  // - 首页：初始 overlay（透明 + 白字），下滑后变成白底 bar + 深色字
  // - 非首页：默认就是白底 bar（深色字）
  function applyState() {
    const y = window.scrollY || document.documentElement.scrollTop || 0;

    if (!isHome) {
      document.documentElement.classList.remove("ct-nav--overlay");
      document.documentElement.classList.add("ct-nav--solid");
      return;
    }

    if (y <= 8) {
      document.documentElement.classList.add("ct-nav--overlay");
      document.documentElement.classList.remove("ct-nav--solid");
    } else {
      document.documentElement.classList.remove("ct-nav--overlay");
      document.documentElement.classList.add("ct-nav--solid");
    }
  }

  applyState();
  window.addEventListener("scroll", applyState, { passive: true });
  window.addEventListener("resize", applyState);

})();
</script>
